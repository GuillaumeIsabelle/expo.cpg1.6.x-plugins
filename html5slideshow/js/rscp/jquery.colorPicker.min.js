(function(a){var e,k,n=0,q=a('<div class="colorPicker-picker">&nbsp;</div>'),r=a('<div id="colorPicker_palette" class="colorPicker-palette" />'),t=a('<div class="colorPicker-swatch">&nbsp;</div>'),u=a('<label for="colorPicker_hex">Hex</label>'),v=a('<input type="text" id="colorPicker_hex" />'),f;a.fn.colorPicker=function(b){return this.each(function(){var c=a(this),d=a.extend({},a.fn.colorPicker.defaults,b),e=a.fn.colorPicker.toHex(0<c.val().length?c.val():d.pickerDefault),g=q.clone(),l=r.clone().attr("id",
"colorPicker_palette-"+n),p=u.clone(),h=v.clone(),f=l[0].id,m,k;a(g)[0].prevCB=d.prevCB;a.each(d.colors,function(b){m=t.clone();"transparent"===d.colors[b]?(m.addClass("transparent").text("X"),a.fn.colorPicker.bindPalette(h,m,"transparent")):(m.css("background-color","#"+this),a.fn.colorPicker.bindPalette(h,m));m.appendTo(l)});p.attr("for","colorPicker_hex-"+n);h.attr({id:"colorPicker_hex-"+n,value:e});h.bind("keydown",function(b){if(13===b.keyCode){var d=a.fn.colorPicker.toHex(a(this).val());a.fn.colorPicker.changeColor(d?
d:c.val())}27===b.keyCode&&a.fn.colorPicker.hidePalette()});h.bind("keyup",function(b){var c=a.fn.colorPicker.toHex(a(b.target).val());a.fn.colorPicker.previewColor(c?c:a(b.target).val())});a('<div class="colorPicker_hexWrap" />').append(p).appendTo(l);l.find(".colorPicker_hexWrap").append(h);!1===d.showHexField&&(h.hide(),p.hide());a("body").append(l);l.hide();g.css("background-color",e);g.bind("click",function(){c.is(":not(:disabled)")&&a.fn.colorPicker.togglePalette(a("#"+f),a(this))});b&&b.onColorChange?
g.data("onColorChange",b.onColorChange):g.data("onColorChange",function(){});(k=c.attr("data-text"))&&g.html(k);c.after(g);c.bind("change",function(){c.next(".colorPicker-picker").css("background-color",a.fn.colorPicker.toHex(a(this).val()))});c.val(e);"input"===c[0].tagName.toLowerCase()?c.each(function(){this.type="hidden"}):c.hide();n++})};a.extend(!0,a.fn.colorPicker,{toHex:function(a){if(a.match(/[0-9A-F]{6}|[0-9A-F]{3}$/i))return"#"===a.charAt(0)?a:"#"+a;if(a.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/)||
a.match(/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,/)){var b=[parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10)],d=function(a){if(2>a.length)for(var b=0,c=2-a.length;b<c;b++)a="0"+a;return a};if(3===b.length){a=d(b[0].toString(16));var e=d(b[1].toString(16));b=d(b[2].toString(16));return"#"+a+e+b}}else return!1},checkMouse:function(b,c){var d=k,f=a(b.target).parents("#"+d.attr("id")).length;b.target===a(d)[0]||b.target===e[0]||0<f||a.fn.colorPicker.hidePalette()},hidePalette:function(){a(document).unbind("mousedown",
a.fn.colorPicker.checkMouse);a(".colorPicker-palette").hide()},showPalette:function(b){var c=e.prev("input").val();b.css({top:e.offset().top+e.outerHeight(),left:e.offset().left-b.width()});a("#color_value").val(c);b.show();a(document).bind("mousedown",a.fn.colorPicker.checkMouse)},togglePalette:function(b,c){c&&(e=c);k=b;k.is(":visible")?a.fn.colorPicker.hidePalette():a.fn.colorPicker.showPalette(b)},changeColor:function(b){e.css("background-color",b);e.prev("input").val(b).change();a.fn.colorPicker.hidePalette();
e.data("onColorChange").call(e,a(e).prev("input").attr("id"),b)},previewColor:function(b){e.css("background-color",b);a(e)[0].prevCB(b)},bindPalette:function(b,c,d){d=d?d:a.fn.colorPicker.toHex(c.css("background-color"));c.bind("click",function(b){f=d;a.fn.colorPicker.changeColor(d)});c.bind("mouseover",function(c){f=b.val();a(this).css("border-color","#598FEF");b.val(d);a.fn.colorPicker.previewColor(d)});c.bind("mouseout",function(c){a(this).css("border-color","#000");b.val(e.css("background-color"));
b.val(f);a.fn.colorPicker.previewColor(f)})}});a.fn.colorPicker.defaults={pickerDefault:"FFFFFF",colors:"000000 993300 333300 000080 333399 333333 800000 FF6600 808000 008000 008080 0000FF 666699 808080 FF0000 FF9900 99CC00 339966 33CCCC 3366FF 800080 999999 FF00FF FFCC00 FFFF00 00FF00 00FFFF 00CCFF 993366 C0C0C0 FF99CC FFCC99 FFFF99 CCFFFF 99CCFF FFFFFF".split(" "),addColors:[],prevCB:function(a){},showHexField:!0}})(jQuery);